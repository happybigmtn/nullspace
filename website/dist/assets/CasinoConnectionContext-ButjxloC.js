import{a as e,c as O,C as A,j as M}from"./index-B-AtvNOI.js";function N(r="/api"){const[f,s]=e.useState("connecting"),[K,y]=e.useState(void 0),[V,p]=e.useState(void 0),[W,v]=e.useState(null),[j,w]=e.useState(null),[F,h]=e.useState(null),[P,b]=e.useState(null),d=e.useRef(null);e.useEffect(()=>{let i=!1,c=null,n=null;return(async()=>{var a,l,C,S,x,m;try{p(void 0),y(void 0);const o="92b050b6fbe80695b5d56835e978918e37c8707a7fad09a01ae782d4c3170c9baa4c2c196b36eac6b78ceb210b287aeb0727ef1c60e48042142f7bcc8b6382305cd50c5a4542c44ec72a4de6640c194f8ef36bea1dbed168ab6fd8681d910d55";s("connecting");const g=new O(o),t=new A(r,g);n=t,await t.init();const u=t.getOrCreateKeypair();if(!u){try{(a=t.destroy)==null||a.call(t)}catch{}s("vault_locked"),y("Unlock passkey vault (Vault tab).");return}await t.switchUpdates(u.publicKey),await((l=t.waitForFirstSeed)==null?void 0:l.call(t).catch(()=>{}));const H=await t.getAccount(u.publicKey);if(await t.initNonceManager(u.publicKeyHex,u.publicKey,H),i){try{(C=t.destroy)==null||C.call(t)}catch{}return}d.current=t,w(g),v(t),h(u),b(((S=t.getCurrentView)==null?void 0:S.call(t))??null),s("connected"),c=(x=t.onEvent)==null?void 0:x.call(t,"Seed",()=>{var E;b(((E=t.getCurrentView)==null?void 0:E.call(t))??null)})}catch(o){if(i)return;try{(m=n==null?void 0:n.destroy)==null||m.call(n)}catch{}s("error"),p((o==null?void 0:o.message)??String(o)),y("Failed to connect. Check simulator + dev-executor.")}})(),()=>{var a,l;i=!0;try{c==null||c()}catch{}c=null;try{(l=(a=d.current)==null?void 0:a.destroy)==null||l.call(a)}catch{}d.current=null,v(null),w(null),h(null),b(null)}},[r]);const R=e.useCallback(async()=>{},[]),D=e.useCallback((i,c)=>{const n=d.current;return n!=null&&n.onEvent?n.onEvent(i,c):()=>{}},[]);return{status:f,statusDetail:K,error:V,client:W,wasm:j,keypair:F,currentView:P,refreshOnce:R,onEvent:D}}const k=e.createContext(null);function q({baseUrl:r="/api",children:f}){const s=N(r);return M.jsx(k.Provider,{value:s,children:f})}function z(){const r=e.useContext(k);if(!r)throw new Error("useSharedCasinoConnection must be used within CasinoConnectionProvider");return r}export{q as C,z as u};
